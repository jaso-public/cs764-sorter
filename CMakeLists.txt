cmake_minimum_required(VERSION 3.27)
project(cs764_sorter)

set(CMAKE_CXX_STANDARD 17)

include_directories(.)

add_executable(cs764_sorter
        Assert.cpp
        Consumer.cpp
        Consumer.h
        OutlinedFiles/defs.cpp
        OutlinedFiles/defs.h
        OutlinedFiles/Filter.cpp
        OutlinedFiles/Filter.h
        OutlinedFiles/Iterator.cpp
        OutlinedFiles/Iterator.h
        Providers/Provider.h
        Providers/SingleProvider.h
        Providers/SingleProvider.cpp
        Providers/EmptyProvider.h
        Providers/EmptyProvider.cpp
        Providers/StagedProvider.h
        Providers/StagedProvider.cpp
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        OutlinedFiles/Scan.cpp
        OutlinedFiles/Scan.h
        Sort/Sort.cpp
        Sort/Sort.h
        TournamentPQ.cpp
        TournamentPQ.h
        Witness.cpp
        Witness.h
        IODevice.h
        IODevice.cpp
        Sim.cpp
        Testing/TestProviders/Printer.cpp
        Testing/TestProviders/Printer.h
        Sort/Sorter.h
        Config/SorterConfig.cpp
        Config/SorterConfig.h
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Testing/SortingHelpers/NoopSorter.h
        Testing/SortingHelpers/NoopSorter.cpp
        Sort/Sorter.cpp
        Run.h
        Run.cpp
        Providers/MemoryProvider.h
        Providers/MemoryProvider.cpp
        Records/CreateRecords.h
)

add_executable(createRecords
        Records/CreateRecords.h
        Records/CreateRecords.cpp
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
)

add_executable(testInOrderGenerator
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Testing/TestProviders/InOrderGenerator.cpp
        Testing/TestProviders/InOrderGenerator.h
        Testing/Tests/Providers/InOrderGeneratorTest.cpp
        Testing/Tests/Providers/InOrderGeneratorTest.h
)

add_executable(testDropFirst
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Testing/TestProviders/InOrderGenerator.cpp
        Testing/TestProviders/InOrderGenerator.h
        Testing/TestProviders/DropFirst.cpp
        Testing/TestProviders/DropFirst.h
        Testing/Tests/Providers/DropFirstTest.cpp
        Testing/Tests/Providers/DropFirstTest.cpp
        Witness.h
        Witness.cpp

)

add_executable(testConsumer
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Testing/TestProviders/InOrderGenerator.cpp
        Testing/TestProviders/InOrderGenerator.h
        Testing/Tests/ConsumerTest.cpp
        Testing/Tests/ConsumerTest.h
        Consumer.cpp
        Consumer
)

add_executable(testDuplicateRemoval
        Testing/Tests/DuplicateRemoval/TestDuplicateRemoval.cpp
        Testing/Tests/DuplicateRemoval/TestDuplicateRemoval.h
        DuplicateRemoval/RemoveDuplicates.cpp
        DuplicateRemoval/RemoveDuplicates.h
)

add_executable(testWitness
        Providers/Provider.h
        Witness.h
        Witness.cpp
        Testing/TestProviders/InOrderGenerator.h
        Testing/TestProviders/InOrderGenerator.cpp
        Testing/SortingHelpers/NoopSorter.h
        Testing/SortingHelpers/NoopSorter.cpp
        Consumer.h
        Consumer.cpp
        Testing/TestProviders/DropFirst.h
        Testing/TestProviders/DropFirst.cpp
        Testing/SortingHelpers/TreeSorter.h
        Testing/SortingHelpers/TreeSorter.cpp
        Testing/SortingHelpers/Key.h
        Testing/SortingHelpers/Key.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Testing/Tests/WitnessTest.cpp
        Testing/Tests/WitnessTest.h
)

add_executable(testPQ
        Providers/Provider.h
        Witness.h
        Witness.cpp
        Testing/TestProviders/InOrderGenerator.h
        Testing/TestProviders/InOrderGenerator.cpp
        Testing/Tests/TournamentPqTest.cpp
        Testing/Tests/TournamentPqTest.h
        Testing/TestProviders/InOrderGenerator.cpp
        Consumer.h
        Consumer.cpp
        TournamentPQ.cpp
        TournamentPQ.h
        Testing/TestProviders/ArrayProvider.cpp
        Testing/TestProviders/ArrayProvider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
)

add_executable(testSorting
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/SorterTest.cpp
        Testing/Tests/SorterTest.h
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
)

add_executable(testLotsOfHddRuns
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/LotsOfHddRuns.cpp
        Testing/Tests/LotsOfHddRuns.h
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/SortingHelpers/CrcRandomGenerator.cpp
        Testing/SortingHelpers/CrcRandomGenerator.h
)

add_executable(testSpillToHdd
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/Spilling/SpillToHdd.cpp
        Testing/Tests/Spilling/SpillToHdd.h
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/SortingHelpers/CrcRandomGenerator.cpp
        Testing/SortingHelpers/CrcRandomGenerator.h
)

add_executable(testSpillToOneBlockToSdd
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/Spilling/SpillOneBlockToSsd.cpp
        Testing/Tests/Spilling/SpillOneBlockToSsd.cpp
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/SortingHelpers/CrcRandomGenerator.cpp
        Testing/SortingHelpers/CrcRandomGenerator.h
)

add_executable(testRecord
    Testing/Tests/Record/RecordTest.cpp
        Testing/Tests/Record/RecordTest.h
)

add_executable(testStorageProvider
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/Providers/StorageProviderTest.h
        Testing/Tests/Providers/StorageProviderTest.cpp
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/SortingHelpers/CrcRandomGenerator.cpp
        Testing/SortingHelpers/CrcRandomGenerator.h
)

add_executable(testStagedProvider
        Providers/Provider.h
        Records/Record.cpp
        Records/Record.h
        Records/rng.cpp
        Records/rng.h
        Config/SorterConfig.h
        Config/SorterConfig.cpp
        Config/StagingConfig.h
        Config/StagingConfig.cpp
        Run.cpp
        Run.h
        Providers/SingleProvider.cpp
        Providers/SingleProvider.h
        Providers/EmptyProvider.cpp
        Providers/EmptyProvider.h
        Providers/MemoryProvider.cpp
        Providers/MemoryProvider.h
        Providers/StorageProvider.h
        Providers/StorageProvider.cpp
        Providers/StagedProvider.cpp
        Providers/StagedProvider.h
        TournamentPQ.cpp
        TournamentPQ.h
        IODevice.h
        IODevice.cpp
        Testing/Tests/Providers/StagedProviderTest.cpp
        Testing/Tests/Providers/StagedProviderTest.h
        Sort/Sorter.cpp
        Sort/Sorter.h
        Consumer.cpp
        Consumer.h
        Witness.cpp
        Witness.h
        Testing/TestProviders/RandomGenerator.h
        Testing/TestProviders/RandomGenerator.cpp
        Testing/TestProviders/Printer.h
        Testing/TestProviders/Printer.cpp
        Testing/SortingHelpers/CrcRandomGenerator.cpp
        Testing/SortingHelpers/CrcRandomGenerator.h
)

add_custom_target(runAllTests
        COMMAND $<TARGET_FILE:testDuplicateRemoval>
        COMMAND $<TARGET_FILE:testWitness>
        COMMAND $<TARGET_FILE:testPQ>
        COMMAND $<TARGET_FILE:testSorting>
        COMMAND $<TARGET_FILE:testLotsOfHddRuns>
        COMMAND $<TARGET_FILE:testSpillToHdd>
        COMMAND $<TARGET_FILE:testRecord>
        COMMAND $<TARGET_FILE:testStorageProvider>
        COMMAND $<TARGET_FILE:testStagedProvider>
        COMMAND $<TARGET_FILE:testInOrderGenerator>
        COMMAND $<TARGET_FILE:testConsumer>
        COMMAND $<TARGET_FILE:testDropFirst>
)